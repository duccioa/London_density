{
    "collab_server" : "",
    "contents" : "library(data.table)\nsource('/Users/duccioa/CLOUD/01_Cloud/01_Work/02_DataScience/02_Functions/R/add_alpha.R')\nroot_dir = '/Users/duccioa/CLOUD/01_Cloud/01_Work/04_Projects/0026_LondonDensity'\nblocks = data.table(read.csv(paste0(root_dir, '/05_Data/00_DbDump/block_h350.csv'), stringsAsFactors = F))\nblocks$caz = gsub(\"t\", \"1\", blocks$caz)\nblocks$caz = gsub(\"f\", \"0\", blocks$caz)\nblocks$caz = as.logical(as.numeric(blocks$caz))\n\n#### H 300 ####\n# GSI distribution\nhist_col = 'mediumslateblue'\nhist_border = 'white'\ncex_main = 2.2\ncex_axis = 1.8\ncex_lab = 2\nhist_mar = c(6,6,6,2)\nhist_ylim = c(0,5)\nlwd_median = 2\n\npng(paste0(root_dir, '/03_Figures/160920_LondonDensity/dist_gsi_caz.png'), width = 1000, height = 1000)\npar(cex.main = cex_main, cex.axis = cex_axis, cex.lab = cex_lab, mar = hist_mar)\nm = median(blocks$gsi[blocks$caz== TRUE])\nhist(blocks$gsi[blocks$caz== TRUE & blocks$gsi>quantile(blocks$gsi, 0.025)], \n     breaks = 20,\n     freq = F, \n     ylim = hist_ylim,\n     col = hist_col,\n     border = hist_border,\n     main = 'London within CAZ \\nGSI Frequency Distribution',\n     xlab = 'GSI',\n     ylab = 'Occurrence'\n     ) # CAZ\nabline(v = m, col = 'red', lwd = lwd_median)\ntext(x = 0.8, y = 3.5, \n     labels = paste0( 'median = ', round(m, 2)), \n     col = 'red',\n     cex  = 2 \n     )\ndev.off()\n\npng(paste0(root_dir, '/03_Figures/160920_LondonDensity/dist_gsi_no-caz.png'), width = 1000, height = 1000)\npar(cex.main = cex_main, cex.axis = cex_axis, cex.lab = cex_lab, mar = hist_mar)\nm = median(blocks$gsi[blocks$caz== FALSE])\nhist(blocks$gsi[blocks$caz== FALSE & quantile(blocks$gsi, 0.025)], \n     breaks = 20,\n     freq = F, \n     ylim = hist_ylim,\n     col = hist_col,\n     border = hist_border,\n     main = 'London outside CAZ \\nGSI Frequency Distribution',\n     xlab = 'GSI',\n     ylab = 'Occurence'\n) # no CAZ\nabline(v = m, col = 'red', lwd = lwd_median)\ntext(x = 0.8, y = 3.5, \n     labels = paste0( 'median = ', round(m, 2)), \n     col = 'red',\n     cex  = 2 \n     )\ndev.off()\n\n# FSI distribution\nhist_col = 'lightsalmon'\nhist_border = 'white'\ncex_main = 2.2\ncex_axis = 1.8\ncex_lab = 2\nhist_mar = c(6,6,6,2)\nhist_ylim = c(0,5)\nhist_xlim1 = c(0,12)\nhist_xlim2 = c(0,12)\nlwd_median = 2\n\npng(paste0(root_dir, '/03_Figures/160920_LondonDensity/dist_far_h300_caz.png'), width = 1000, height = 1000)\npar(cex.main = cex_main, cex.axis = cex_axis, cex.lab = cex_lab, mar = hist_mar)\nm = median(blocks$fsi_h300[blocks$caz== TRUE])\nhist(blocks$fsi_h300[blocks$caz== TRUE], \n     breaks = 50,\n     freq = F, \n     #ylim = yhist_lim,\n     xlim = hist_xlim1, \n     col = hist_col,\n     border = hist_border,\n     main = 'London within CAZ \\nFAR Frequency Distribution',\n     xlab = 'FAR',\n     ylab = 'Occurence'\n) # CAZ\nabline(v = m, col = 'red', lwd = lwd_median)\ntext(x = 6, y = 0.18, \n     labels = paste0( 'median = ', round(m, 2)), \n     col = 'red',\n     cex  = 2 \n)\ndev.off()\n\npng(paste0(root_dir, '/03_Figures/160920_LondonDensity/dist_far_h300_no-caz.png'), width = 1000, height = 1000)\npar(cex.main = cex_main, cex.axis = cex_axis, cex.lab = cex_lab, mar = hist_mar)\nm = median(blocks$fsi_h300[blocks$caz== FALSE])\nhist(blocks$fsi_h300[blocks$caz== FALSE], \n     breaks = 50,\n     freq = F, \n     #ylim = yhist_lim,\n     xlim = hist_xlim2,\n     col = hist_col,\n     border = hist_border,\n     main = 'London outside CAZ \\nFAR Frequency Distribution',\n     xlab = 'FAR',\n     ylab = 'Occurence'\n) # no CAZ\nabline(v = m, col = 'red', lwd = lwd_median)\ntext(x = 6, y = 1, \n     labels = paste0( 'median = ', round(m, 2)), \n     col = 'red',\n     cex  = 2 \n)\ndev.off()\n\n#### H 350 ####\n# FSI distribution\nhist_col = 'lightsalmon'\nhist_border = 'white'\ncex_main = 2.2\ncex_axis = 1.8\ncex_lab = 2\nhist_mar = c(6,6,6,2)\nhist_ylim = c(0,5)\nhist_xlim1 = c(0,12)\nhist_xlim2 = c(0,12)\nlwd_median = 2\n\npng(paste0(root_dir, '/03_Figures/20160919_LondonDensity/dist_far_h350_caz.png'), width = 1000, height = 1000)\npar(cex.main = cex_main, cex.axis = cex_axis, cex.lab = cex_lab, mar = hist_mar)\nm = median(blocks$fsi_h350[blocks$caz== TRUE])\nhist(blocks$fsi_h350[blocks$caz== TRUE], \n     breaks = 50,\n     freq = F, \n     #ylim = yhist_lim,\n     xlim = hist_xlim1, \n     col = hist_col,\n     border = hist_border,\n     main = 'London within CAZ \\nFAR Frequency Distribution',\n     xlab = 'FAR'\n) # CAZ\nabline(v = m, col = 'red', lwd = lwd_median)\ntext(x = 6, y = 0.18, \n     labels = paste0( 'median = ', round(m, 2)), \n     col = 'red',\n     cex  = 2 \n)\ndev.off()\n\npng(paste0(root_dir, '/03_Figures/20160919_LondonDensity/dist_far_h350_no-caz.png'), width = 1000, height = 1000)\npar(cex.main = cex_main, cex.axis = cex_axis, cex.lab = cex_lab, mar = hist_mar)\nm = median(blocks$fsi_h350[blocks$caz== FALSE])\nhist(blocks$fsi_h350[blocks$caz== FALSE], \n     breaks = 50,\n     freq = F, \n     #ylim = yhist_lim,\n     xlim = hist_xlim2,\n     col = hist_col,\n     border = hist_border,\n     main = 'London outside CAZ \\nFAR Frequency Distribution',\n     xlab = 'FAR'\n) # no CAZ\nabline(v = m, col = 'red', lwd = lwd_median)\ntext(x = 6, y = 1, \n     labels = paste0( 'median = ', round(m, 2)), \n     col = 'red',\n     cex  = 2 \n)\ndev.off()\n\n# Correlation plots\nlm1 = lm(fsi_h300 ~ gsi, blocks)\nsummary(lm1)\nlm2 = lm(fsi_h300 ~ gsi, blocks[blocks$caz == T,])\nsummary(lm2)\nlm3 = lm(fsi_h300 ~ gsi, blocks[blocks$caz == F,])\nsummary(lm3)\nsample_index = sample(1:nrow(blocks), floor(nrow(blocks)/5))\nblock_sample = blocks[sample_index,]\n\nscat_col = add.alpha('mediumslateblue', 0.4)\nscat_pch = 19\nscat_cex = 0.5\nscat_xlim = c(0,1)\nscat_ylim = c(0,5)\nscat_mar = c(5,6,8,2)\ncex_main = 2.2\ncex_axis = 1.8\ncex_lab = 2\ncex_sum1 = 2\ncex_sum2 = 2\n\n\n\n\npng(paste0(root_dir, '/03_Figures/20160919_LondonDensity/gsi_far_h300_gl.png'), width = 1000, height = 1200)\npar(cex.main = cex_main, cex.axis = cex_axis, cex.lab = cex_lab, \n    mar = scat_mar\n    )\nlayout(matrix(c(1,1,2,2), 2, 2, byrow = T), heights = c(5,1))\nwith(blocks[gsi > quantile(blocks$gsi, 0.025)],\nplot(gsi, fsi_h300, \n     pch = scat_pch, \n     col = scat_col,\n     cex = scat_cex,\n     ylim = scat_ylim,\n     xlim = scat_xlim,\n     main = 'Greater London \\nGSI v. FAR \\navg floor to floor height 300 cm',\n     xlab = 'GSI',\n     ylab = 'FAR',\n     frame.plot = F\n     )\n)\ntext(x = 0.8, y = 4, labels = paste0('Corr. \\n', round(cor(blocks$gsi, blocks$fsi_h300),2)), col = 'red', cex = 2.5)\npar(mar = c(0.2,6,0.2,2))\nplot(x = c(0,1), y = c(0,1/5), type = 'n', axes = F, xlab=\"\", ylab=\"\")\ntext(x = 0.5, y = 0.15, labels = 'Summary FAR', cex = cex_sum1)\nscat_text = summary(blocks$fsi_h300)\nscat_text_x1 = c(0, 1/5, 2/5, 3/5, 4/5, 1)\nscat_text_y1 = 0.09\ntext(x = scat_text_x1, y = scat_text_y1, labels = names(scat_text), cex = cex_sum2)\nscat_text_y2 = 0.06\ntext(x = scat_text_x1, y = scat_text_y2, labels = round(scat_text, 2), cex = cex_sum2)\ndev.off() \n\n\n\n\npng(paste0(root_dir, '/03_Figures/20160919_LondonDensity/gsi_far_h300_caz.png'), width = 1000, height = 1200)\npar(cex.main = cex_main, cex.axis = cex_axis, cex.lab = cex_lab, \n    mar = scat_mar\n)\nlayout(matrix(c(1,1,2,2), 2, 2, byrow = T), heights = c(5,1))\nwith(blocks[gsi > quantile(blocks$gsi, 0.025) & caz == T],\n     plot(gsi, fsi_h300, \n          pch = scat_pch, \n          col = scat_col,\n          cex = scat_cex,\n          ylim = scat_ylim,\n          xlim = scat_xlim,\n          main = 'London within CAZ\\nGSI v. FAR \\navg floor to floor height 300 cm',\n          xlab = 'GSI',\n          ylab = 'FAR',\n          frame.plot = F\n     )\n)\ntext(x = 0.8, y = 4, labels = paste0('Corr. \\n', round(cor(blocks[caz==T]$gsi, blocks[caz==T]$fsi_h300),2)), col = 'red', cex = 2.5)\npar(mar = c(0.2,6,0.2,2))\nplot(x = c(0,1), y = c(0,1/5), type = 'n', axes = F, xlab=\"\", ylab=\"\")\ntext(x = 0.5, y = 0.15, labels = 'Summary FAR', cex = cex_sum1)\nscat_text = summary(blocks[caz==T]$fsi_h300)\nscat_text_x1 = c(0, 1/5, 2/5, 3/5, 4/5, 1)\nscat_text_y1 = 0.09\ntext(x = scat_text_x1, y = scat_text_y1, labels = names(scat_text), cex = cex_sum2)\nscat_text_y2 = 0.06\ntext(x = scat_text_x1, y = scat_text_y2, labels = round(scat_text, 2), cex = cex_sum2)\ndev.off() \n\n\npng(paste0(root_dir, '/03_Figures/20160919_LondonDensity/gsi_far_h300_no-caz.png'), width = 1000, height = 1200)\npar(cex.main = cex_main, cex.axis = cex_axis, cex.lab = cex_lab, \n    mar = scat_mar\n)\nlayout(matrix(c(1,1,2,2), 2, 2, byrow = T), heights = c(5,1))\nwith(blocks[gsi > quantile(blocks$gsi, 0.025) & caz == F],\n     plot(gsi, fsi_h300, \n          pch = scat_pch, \n          col = scat_col,\n          cex = scat_cex,\n          ylim = scat_ylim,\n          xlim = scat_xlim,\n          main = 'London outside CAZ \\nGSI v. FAR \\navg floor to floor height 300 cm',\n          xlab = 'GSI',\n          ylab = 'FAR',\n          frame.plot = F\n     )\n)\ntext(x = 0.8, y = 4, labels = paste0('Corr. \\n', round(cor(blocks[caz==F]$gsi, blocks[caz==F]$fsi_h300),2)), col = 'red', cex = 2.5)\npar(mar = c(0.2,6,0.2,2))\nplot(x = c(0,1), y = c(0,1/5), type = 'n', axes = F, xlab=\"\", ylab=\"\")\ntext(x = 0.5, y = 0.15, labels = 'Summary FAR', cex = cex_sum1)\nscat_text = summary(blocks[caz==F]$fsi_h300)\nscat_text_x1 = c(0, 1/5, 2/5, 3/5, 4/5, 1)\nscat_text_y1 = 0.09\ntext(x = scat_text_x1, y = scat_text_y1, labels = names(scat_text), cex = cex_sum2)\nscat_text_y2 = 0.06\ntext(x = scat_text_x1, y = scat_text_y2, labels = round(scat_text, 2), cex = cex_sum2)\ndev.off() \n",
    "created" : 1473521166799.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "3814188095",
    "id" : "E01D50FA",
    "lastKnownWriteTime" : 1474402754,
    "last_content_update" : 1474402754831,
    "path" : "~/CLOUD/01_Cloud/01_Work/04_Projects/0026_LondonDensity/02_Code/02_R/distribution_graphs.R",
    "project_path" : "distribution_graphs.R",
    "properties" : {
        "tempName" : "Untitled1"
    },
    "relative_order" : 1,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_source"
}